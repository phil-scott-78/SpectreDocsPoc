@using BlazorMonaco
@using BlazorMonaco.Editor

<StandaloneCodeEditor @ref="_editor"
                      Id="code-editor"
                      CssClass="editor-instance"
                      ConstructionOptions="EditorConstructionOptions" />

<style>
    .editor-instance {
        width: 100%;
        height: 100%;
    }
</style>

@code {
    private StandaloneCodeEditor? _editor;

    private const string DefaultCode = @"using Spectre.Console;

// Welcome to the Spectre.Console Playground!
// Write your code below and click Run to see it in action.

// Figlet text with color
AnsiConsole.Write(
    new FigletText(""Hello!"")
        .Color(Color.Green));

AnsiConsole.WriteLine();

// Interactive text prompt - type your name and press Enter
var name = AnsiConsole.Ask<string>(""What's your [green]name[/]?"");
AnsiConsole.MarkupLine($""Hello, [blue]{name}[/]!"");

AnsiConsole.WriteLine();

// Confirm prompt
if (AnsiConsole.Confirm(""Do you like Spectre.Console?""))
{
    AnsiConsole.MarkupLine(""[green]Awesome![/] Thanks for the feedback!"");
}
else
{
    AnsiConsole.MarkupLine(""[yellow]That's okay![/] We're always improving."");
}

AnsiConsole.WriteLine();

// Show a table with results
var table = new Table();
table.Border(TableBorder.Rounded);
table.AddColumn(""[cyan]Property[/]"");
table.AddColumn(""[cyan]Value[/]"");
table.AddRow(""Name"", $""[blue]{name}[/]"");
table.AddRow(""Time"", $""[yellow]{DateTime.Now:HH:mm:ss}[/]"");
AnsiConsole.Write(table);

// A rule to finish
var rule = new Rule(""[green]Thanks for trying Spectre.Console![/]"");
AnsiConsole.Write(rule);
";

    private StandaloneEditorConstructionOptions EditorConstructionOptions(StandaloneCodeEditor editor)
    {
        return new StandaloneEditorConstructionOptions
        {
            AutomaticLayout = true,
            Language = "csharp",
            Theme = "vs-dark",
            Value = DefaultCode,
            FontSize = 14,
            FontFamily = "\"Cascadia Code\", \"Fira Code\", Consolas, monospace",
            Minimap = new EditorMinimapOptions { Enabled = false },
            ScrollBeyondLastLine = false,
            RenderLineHighlight = "all",
            WordWrap = "on",
            TabSize = 4,
            InsertSpaces = true
        };
    }

    public async Task<string> GetCode()
    {
        if (_editor == null)
            return string.Empty;

        return await _editor.GetValue();
    }

    public async Task SetCode(string code)
    {
        if (_editor != null)
        {
            await _editor.SetValue(code);
        }
    }
}
